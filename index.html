<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet" />

    <script
      type="module"
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
  </head>
  <body>
    <div id="container">
      <div class="content active" id="home">
        <div class="main">
          <div class="logo">
            <div class="identity">
              <img src="images/logo 1.png" alt="" />
            </div>
          </div>
          <div class="border"></div>
          <div class="bengali">
            <h2>আপনার বাসায় গ্যাস সিলিন্ডার শেষ?</h2>
            <h3>চিন্তা নেই!!!</h3>
            <h4>
              আপনার বাসায় গ্যাস সিলিন্ডার পৌছে দিতে আমরা সর্বদা প্রস্তুত...
            </h4>
          </div>
          <div id="gaz">
            <div class="box">
              <div class="gas-bg">
                <img src="slide/g.png" alt="" />
                <div>
                  <p class="weight">12kg / 22mm</p>
                  <div class="gas-text">
                    <p class="name">Without Cylinder</p>
                    <p class="mrp"><span id="price1">00</span>tk</p>
                    <div class="border-pr"></div>
                    <p class="name">With Cylinder</p>
                    <p class="mrp"><span id="price2">00</span>tk</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="box">
              <div class="gas-bg">
                <img src="slide/delta.png" alt="" />
                <div>
                  <p class="weight">12kg / 22mm</p>
                  <div class="gas-text">
                    <p class="name">Without Cylinder</p>
                    <p class="mrp"><span id="price3">00</span>tk</p>
                    <div class="border-pr"></div>
                    <p class="name">With Cylinder</p>
                    <p class="mrp"><span id="price4">00</span>tk</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="box">
              <div class="gas-bg">
                <img src="slide/jamuna.png" alt="" />
                <div>
                  <p class="weight">12kg / 22mm</p>
                  <div class="gas-text">
                    <p class="name">Without Cylinder</p>
                    <p class="mrp"><span id="price5">00</span>tk</p>
                    <div class="border-pr"></div>
                    <p class="name">With Cylinder</p>
                    <p class="mrp"><span id="price6">00</span>tk</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="box">
              <div class="gas-bg">
                <img src="slide/euro.png" alt="" />
                <div>
                  <p class="weight">12kg / 22mm</p>
                  <div class="gas-text">
                    <p class="name">Without Cylinder</p>
                    <p class="mrp"><span id="price7">00</span>tk</p>
                    <div class="border-pr"></div>
                    <p class="name">With Cylinder</p>
                    <p class="mrp"><span id="price8">00</span>tk</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="box">
              <div class="gas-bg">
                <img src="slide/basundhara.png" alt="" />
                <div>
                  <p class="weight">12kg / 22mm</p>
                  <div class="gas-text">
                    <p class="name">Without Cylinder</p>
                    <p class="mrp"><span id="price9">00</span>tk</p>
                    <div class="border-pr"></div>
                    <p class="name">With Cylinder</p>
                    <p class="mrp"><span id="price10">00</span>tk</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="box">
              <div class="gas-bg">
                <img src="slide/ay.png" alt="" />
                <div>
                  <p class="weight">12kg / 22mm</p>
                  <div class="gas-text">
                    <p class="name">Without Cylinder</p>
                    <p class="mrp"><span id="price11">00</span>tk</p>
                    <div class="border-pr"></div>
                    <p class="name">With Cylinder</p>
                    <p class="mrp"><span id="price12">00</span>tk</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="box">
              <div class="gas-bg">
                <img src="slide/uni.png" alt="" />
                <div>
                  <p class="weight">12kg / 22mm</p>
                  <div class="gas-text">
                    <p class="name">Without Cylinder</p>
                    <p class="mrp"><span id="price13">00</span>tk</p>
                    <div class="border-pr"></div>
                    <p class="name">With Cylinder</p>
                    <p class="mrp"><span id="price14">00</span>tk</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="box">
              <div class="gas-bg">
                <img src="slide/jmi.png" alt="" />
                <div>
                  <p class="weight">12kg / 22mm</p>
                  <div class="gas-text">
                    <p class="name">Without Cylinder</p>
                    <p class="mrp"><span id="price15">00</span>tk</p>
                    <div class="border-pr"></div>
                    <p class="name">With Cylinder</p>
                    <p class="mrp"><span id="price16">00</span>tk</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="box">
              <div class="gas-bg">
                <img src="slide/total.png" alt="" />
                <div>
                  <p class="weight">12kg / 20mm</p>
                  <div class="gas-text">
                    <p class="name">Without Cylinder</p>
                    <p class="mrp"><span id="price17">00</span>tk</p>
                    <div class="border-pr"></div>
                    <p class="name">With Cylinder</p>
                    <p class="mrp"><span id="price18">00</span>tk</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="box">
              <div class="gas-bg">
                <img src="slide/petro.png" alt="" />
                <div>
                  <p class="weight">12kg / 22mm</p>
                  <div class="gas-text">
                    <p class="name">Without Cylinder</p>
                    <p class="mrp"><span id="price19">00</span>tk</p>
                    <div class="border-pr"></div>
                    <p class="name">With Cylinder</p>
                    <p class="mrp"><span id="price20">00</span>tk</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <p class="order">অর্ডার করতেঃ</p>

          <a href="tel:01754841553">
            <button class="phone-button">
              <ion-icon name="call"></ion-icon>
              <p style="font-family: myFont">ফোন করুন</p>
            </button>
          </a>
        </div>
      </div>
      <div class="content" id="user">
        <h3>Login</h3>
        <form class="login-form" id="loginForm">
          <input type="text" id="userId" placeholder="User ID" />
          <input type="password" id="password" placeholder="Password" />
          <button type="submit" id="login">Login</button>
        </form>
        <div class="edit-price">
          <div class="price">
            <h4>গ্যাসের দাম পরিবর্তন করুনঃ</h4>
            <div class="price-box">
              <h5>G Gas</h5>
              <input
                type="text"
                id="newPrice1"
                placeholder="Without Cylinder :" />
              <input type="text" id="newPrice2" placeholder="With Cylinder" />
            </div>
            <div class="price-box">
              <h5>Delta Gas</h5>
              <input
                type="text"
                id="newPrice3"
                placeholder="Without Cylinder :" />
              <input type="text" id="newPrice4" placeholder="With Cylinder" />
            </div>
            <div class="price-box">
              <h5>Jamuna Gas</h5>
              <input
                type="text"
                id="newPrice5"
                placeholder="Without Cylinder :" />
              <input type="text" id="newPrice6" placeholder="With Cylinder" />
            </div>
            <div class="price-box">
              <h5>Euro Gas</h5>
              <input
                type="text"
                id="newPrice7"
                placeholder="Without Cylinder :" />
              <input type="text" id="newPrice8" placeholder="With Cylinder" />
            </div>
            <div class="price-box">
              <h5>Basundhara Gas</h5>
              <input
                type="text"
                id="newPrice9"
                placeholder="Without Cylinder :" />
              <input type="text" id="newPrice10" placeholder="With Cylinder" />
            </div>
            <div class="price-box">
              <h5>Ay Gas</h5>
              <input
                type="text"
                id="newPrice11"
                placeholder="Without Cylinder :" />
              <input type="text" id="newPrice12" placeholder="With Cylinder" />
            </div>
            <div class="price-box">
              <h5>Uni Gas</h5>
              <input
                type="text"
                id="newPrice13"
                placeholder="Without Cylinder :" />
              <input type="text" id="newPrice14" placeholder="With Cylinder" />
            </div>
            <div class="price-box">
              <h5>JMI Gas</h5>
              <input
                type="text"
                id="newPrice15"
                placeholder="Without Cylinder :" />
              <input type="text" id="newPrice16" placeholder="With Cylinder" />
            </div>
            <div class="price-box">
              <h5>Total Gas</h5>
              <input
                type="text"
                id="newPrice17"
                placeholder="Without Cylinder :" />
              <input type="text" id="newPrice18" placeholder="With Cylinder" />
            </div>
            <div class="price-box">
              <h5>Petromax Gas</h5>
              <input
                type="text"
                id="newPrice19"
                placeholder="Without Cylinder :" />
              <input type="text" id="newPrice20" placeholder="With Cylinder" />
            </div>
            <button id="savePriceBtn">Save Prices</button>
          </div>
        </div>
      </div>
      <div class="tabs">
        <div class="tab active" id="homeTab">
          <ion-icon name="home-outline"></ion-icon>
        </div>
        <div class="tab" id="userTab">
          <ion-icon name="person-outline"></ion-icon>
        </div>
      </div>
    </div>
    <!-- <script src="script.js"></script>
    <script src="tab.js"></script> -->
    <script type="module">
      // Firebase configuration and initialization
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.0/firebase-app.js";
      import {
        getFirestore,
        doc,
        setDoc,
        getDoc,
        updateDoc, // Add this line
      } from "https://www.gstatic.com/firebasejs/9.17.0/firebase-firestore.js";

      // Your web app's Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyArKcQCfuXNuoEfoaYxeqIIgG4dLd9b1wI",
        authDomain: "gas-app-912ad.firebaseapp.com",
        projectId: "gas-app-912ad",
        storageBucket: "gas-app-912ad.appspot.com",
        messagingSenderId: "771724855337",
        appId: "1:771724855337:web:8186ec97d96b44805d3438",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      // Tab switching functionality
      document.addEventListener("DOMContentLoaded", () => {
        const homeTab = document.getElementById("homeTab");
        const userTab = document.getElementById("userTab");
        const homeContent = document.getElementById("home");
        const userContent = document.getElementById("user");

        homeTab.addEventListener("click", () => {
          homeTab.classList.add("active");
          userTab.classList.remove("active");
          homeContent.classList.add("active");
          userContent.classList.remove("active");
        });

        userTab.addEventListener("click", () => {
          userTab.classList.add("active");
          homeTab.classList.remove("active");
          userContent.classList.add("active");
          homeContent.classList.remove("active");
        });
      });

      // Login functionality
      const loginForm = document.getElementById("loginForm");
      const editPriceSection = document.querySelector(".edit-price");

      loginForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const userId = document.getElementById("userId").value;
        const password = document.getElementById("password").value;

        if (userId === "omarfarukme77" && password === "017027985") {
          alert("Welcome MR.RAMON");
          editPriceSection.style.display = "block";
        } else {
          alert("Log in Failed!!!");
        }
      });
      // Ensure the script runs after the DOM is fully loaded
      document.addEventListener("DOMContentLoaded", function () {
        // Array of identifiers for each gas type
        const gasTypes = [
          {
            name: "GGas",
            priceWithout: "newPrice1",
            priceWith: "newPrice2",
            displayWithout: "price1",
            displayWith: "price2",
          },
          {
            name: "DeltaGas",
            priceWithout: "newPrice3",
            priceWith: "newPrice4",
            displayWithout: "price3",
            displayWith: "price4",
          },
          {
            name: "JamunaGas",
            priceWithout: "newPrice5",
            priceWith: "newPrice6",
            displayWithout: "price5",
            displayWith: "price6",
          },
          {
            name: "EuroGas",
            priceWithout: "newPrice7",
            priceWith: "newPrice8",
            displayWithout: "price7",
            displayWith: "price8",
          },
          {
            name: "BasundharaGas",
            priceWithout: "newPrice9",
            priceWith: "newPrice10",
            displayWithout: "price9",
            displayWith: "price10",
          },
          {
            name: "AyGas",
            priceWithout: "newPrice11",
            priceWith: "newPrice12",
            displayWithout: "price11",
            displayWith: "price12",
          },
          {
            name: "UniGas",
            priceWithout: "newPrice13",
            priceWith: "newPrice14",
            displayWithout: "price13",
            displayWith: "price14",
          },
          {
            name: "JMIGas",
            priceWithout: "newPrice15",
            priceWith: "newPrice16",
            displayWithout: "price15",
            displayWith: "price16",
          },
          {
            name: "TotalGas",
            priceWithout: "newPrice17",
            priceWith: "newPrice18",
            displayWithout: "price17",
            displayWith: "price18",
          },
          {
            name: "PetromaxGas",
            priceWithout: "newPrice19",
            priceWith: "newPrice20",
            displayWithout: "price19",
            displayWith: "price20",
          },
        ];

        // Add an event listener to the save price button
        const savePriceBtn = document.getElementById("savePriceBtn");

        savePriceBtn.addEventListener("click", async function () {
          let anyUpdated = false;

          for (const gas of gasTypes) {
            const newPriceWithout = document.getElementById(
              gas.priceWithout
            ).value;
            const newPriceWith = document.getElementById(gas.priceWith).value;

            try {
              // Fetch existing data to avoid overwriting
              const priceDoc = doc(db, "gasPrices", gas.name);
              const docSnap = await getDoc(priceDoc);

              let updatedData = {};

              if (docSnap.exists()) {
                const existingData = docSnap.data();

                // Update only the new values
                updatedData = {
                  withoutCylinder:
                    newPriceWithout !== ""
                      ? newPriceWithout
                      : existingData.withoutCylinder,
                  withCylinder:
                    newPriceWith !== ""
                      ? newPriceWith
                      : existingData.withCylinder,
                };
              } else {
                // If the document doesn't exist, initialize it with new values
                updatedData = {
                  withoutCylinder: newPriceWithout,
                  withCylinder: newPriceWith,
                };
              }

              // Update Firestore with the new prices
              await updateDoc(priceDoc, updatedData);

              // Update the displayed prices
              document.getElementById(gas.displayWithout).textContent =
                updatedData.withoutCylinder;
              document.getElementById(gas.displayWith).textContent =
                updatedData.withCylinder;

              anyUpdated = true; // Set the flag to true since a price was updated
            } catch (error) {
              console.error("Error updating price: ", error);
            }
          }

          // Show a single alert if any prices were updated
          if (anyUpdated) {
            alert("Prices updated successfully!");
          } else {
            alert("No valid prices were entered.");
          }
        });

        // Fetch the current prices from Firestore when the page loads
        const fetchCurrentPrices = async () => {
          for (const gas of gasTypes) {
            const priceDoc = doc(db, "gasPrices", gas.name); // Specify collection and document ID
            const docSnap = await getDoc(priceDoc);

            if (docSnap.exists()) {
              const data = docSnap.data();
              document.getElementById(gas.displayWithout).textContent =
                data.withoutCylinder; // Update price without cylinder
              document.getElementById(gas.displayWith).textContent =
                data.withCylinder; // Update price with cylinder
            } else {
              console.log(`No such document for ${gas.name}!`);
            }
          }
        };

        // Call the function to fetch current prices
        fetchCurrentPrices();
      });
    </script>
  </body>
</html>
